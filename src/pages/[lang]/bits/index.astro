---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";

import BitsCard from "@components/bits/Card.astro";
import PageH1 from "@components/PageH1.astro";
import LogDivider from "@components/LogDivider.astro";
import type { Locale } from "@lib/i18n";
import { BITS_CONTENT } from "src/data/bits-content";

import { getLangStaticPaths } from "@lib/static-paths";

export const getStaticPaths = getLangStaticPaths;

const { lang } = Astro.params as { lang: Locale };
const content = BITS_CONTENT[lang];

const bits = await getCollection("bits");
const sortedBits = bits
  .filter(entry => entry.slug.startsWith(`${lang}/`))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<PageLayout title={content.meta.title} description={content.meta.description} lang={lang}>
  <div class="flex-grow pt-32 pb-20 px-4 md:px-10 max-w-[1400px] mx-auto w-full flex flex-col items-center relative z-10">
    <PageH1 
      title={content.hero.title} 
      subtitle={content.hero.subtitle} 
    />

    <LogDivider label={content.divider} />

    <div class="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {sortedBits.map((project, index) => (
        <BitsCard project={project} lang={lang} index={index + 1} />
      ))}
    </div>
  </div>
</PageLayout>
