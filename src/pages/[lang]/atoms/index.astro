---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";

import AtomsCard from "@components/atoms/Card.astro";
import PageH1 from "@components/PageH1.astro";
import LogDivider from "@components/LogDivider.astro";
import type { Locale } from "@lib/i18n";
import { ATOMS_CONTENT } from "src/data/atoms-content";

import { getLangStaticPaths } from "@lib/static-paths";

export const getStaticPaths = getLangStaticPaths;

const { lang } = Astro.params as { lang: Locale };
const content = ATOMS_CONTENT[lang];

const atoms = await getCollection("atoms");
const sortedAtoms = atoms
  .filter(entry => entry.slug.startsWith(`${lang}/`))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<PageLayout title={content.meta.title} description={content.meta.description} lang={lang}>

    <PageH1 
      title={content.hero.title} 
      subtitle={content.hero.subtitle} 
    />

    <LogDivider label={content.divider} />

    <div class="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {sortedAtoms.map((atom, index) => (
        <AtomsCard atom={atom} lang={lang} index={index + 1} />
      ))}
    </div>

</PageLayout>
