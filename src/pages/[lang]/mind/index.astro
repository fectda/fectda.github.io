---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";

import MindEntry from "@components/mind/Entry.astro"; // Correct path as per recent change
import PageH1 from "@components/PageH1.astro";
import LogDivider from "@components/LogDivider.astro";
import type { Locale } from "@lib/i18n";
import { MIND_CONTENT } from "src/data/mind-content";

import { getLangStaticPaths } from "@lib/static-paths";

export const getStaticPaths = getLangStaticPaths;

const { lang } = Astro.params as { lang: Locale };
const content = MIND_CONTENT[lang];

// Get mind entries filtered by current language
const allMindEntries = await getCollection("mind");
const sortedEntries = allMindEntries
  .filter(entry => entry.slug.startsWith(`${lang}/`) && (!entry.data.draft || import.meta.env.DEV))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<PageLayout title={content.meta.title} description={content.meta.description} lang={lang}>

    <PageH1 
      title={content.hero.title} 
      subtitle={content.hero.subtitle} 
    />

    <LogDivider label={content.divider} />

    <div class="w-full flex flex-col gap-0">
      {sortedEntries.map(entry => (
        <MindEntry entry={entry} lang={lang} readLabel={content.readLabel} />
      ))}
    </div>

</PageLayout>


