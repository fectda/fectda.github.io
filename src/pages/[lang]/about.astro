---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import { type Locale } from "@lib/i18n";
import PageH1 from "@components/PageH1.astro";

import XiuhcoatlDivider from "@components/XiuhcoatlDivider.astro";
import BioTerminal from "@components/about/BioTerminal.astro";
import SangreAzul from "@components/about/SangreAzul.astro";
import Incomodidad from "@components/about/Incomodidad.astro";
import LinajeMaker from "@components/about/LinajeMaker.astro";
import Obsessions from "@components/about/Obsessions.astro";
import { ABOUT_CONTENT } from "@data/about-content";

import { getLangStaticPaths } from "@lib/static-paths";

export const getStaticPaths = getLangStaticPaths;

const { lang } = Astro.params as { lang: Locale };
const content = ABOUT_CONTENT[lang];

const aboutEntries = (await getCollection("about"))
  .filter(entry => entry.slug.startsWith(`${lang}/`));
const aboutEntry = aboutEntries[0];

const pageTitle = aboutEntry?.data.title || content.manifesto.title;
const pageDesc = aboutEntry?.data.description || content.manifesto.subtitle;
---

<PageLayout title={pageTitle} description={pageDesc} lang={lang}>

  <!-- Scanlines overlay -->
  <div class="scanlines"></div>
  <!-- Grid overlay -->
  <div class="fixed inset-0 bg-[size:40px_40px] bg-grid-pattern opacity-[0.05] pointer-events-none"></div>

  <div class="pt-20 md:pt-32 pb-20 px-4 md:px-10 max-w-[1000px] mx-auto w-full flex flex-col gap-12 relative z-10">

    <PageH1 
      title={content.manifesto.title} 
      subtitle={content.manifesto.subtitle} 
    />

    <BioTerminal 
      text={content.manifesto.bio} 
    />

    <XiuhcoatlDivider className="text-gray-600" />

    <SangreAzul 
      title={content.blueBlood.title}
      subtitle={content.blueBlood.subtitle}
      body={content.blueBlood.body}
      tags={content.blueBlood.tags}
    />

    <Incomodidad 
      title={content.discomfort.title}
      warning={content.discomfort.warning}
      body={content.discomfort.body}
    />

    <!-- Spacer with SVG background -->
    <div class="w-full h-10 bg-stepped-fret opacity-70 "></div>

    <LinajeMaker 
      title={content.makerLineage.title}
      id={content.makerLineage.id}
      className={content.makerLineage.class}
      body={content.makerLineage.body}
      badges={content.makerLineage.badges}
    />

    <Obsessions 
      title={content.obsessions.title}
      items={content.obsessions.items}
    />

  </div>

  <style>
    .scanlines {
      background: linear-gradient(
        to bottom,
        rgba(255,255,255,0),
        rgba(255,255,255,0) 50%,
        rgba(0,0,0,0.1) 50%,
        rgba(0,0,0,0.1)
      );
      background-size: 100% 4px;
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 50;
      opacity: 0.15;
    }

    .bg-grid-pattern {
        background-image: linear-gradient(to right, #333 1px, transparent 1px), linear-gradient(to bottom, #333 1px, transparent 1px);
    }

    .bg-stepped-fret {
        background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJub25lIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMSI+PHBhdGggZD0iTTAgNDAgTDIwIDIwIEw0MCA0MCIvPjxwYXRoIGQ9Ik0wIDIwIEwyMCAwIEw0MCAyMCIvPjwvc3ZnPg==');
    }
  </style>

</PageLayout>
