---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import { type Locale } from "@lib/i18n";
import PageH1 from "@components/PageH1.astro";

import XiuhcoatlDivider from "@components/XiuhcoatlDivider.astro";

import BioTerminal from "@components/about/BioTerminal.astro";
import BlueBlood from "@components/about/BlueBlood.astro";
import Discomfort from "@components/about/Discomfort.astro";
import MakerLineage from "@components/about/MakerLineage.astro";
import Obsessions from "@components/about/Obsessions.astro";
import SteppedFretSpacer from "@components/about/SteppedFretSpacer.astro";
import { ABOUT_CONTENT } from "@data/about-content";

import { getLangStaticPaths } from "@lib/static-paths";

export const getStaticPaths = getLangStaticPaths;

const { lang } = Astro.params as { lang: Locale };
const content = ABOUT_CONTENT[lang];

const aboutEntries = (await getCollection("about"))
  .filter(entry => entry.slug.startsWith(`${lang}/`));
const aboutEntry = aboutEntries[0];

const pageTitle = aboutEntry?.data.title || content.manifesto.title;
const pageDesc = aboutEntry?.data.description || content.manifesto.subtitle;
---

<PageLayout title={pageTitle} description={pageDesc} lang={lang} gridOpacity={0.05}>
  <!-- Grid overlay in Layout -->
  <!-- Renamed components trigger -->

  <div class="pt-20 md:pt-32 pb-20 px-4 md:px-10 max-w-[1200px] mx-auto w-full flex flex-col items-center gap-12 relative z-10">

    <PageH1 
      title={content.manifesto.title} 
      subtitle={content.manifesto.subtitle} 
    />

    <BioTerminal 
      text={content.manifesto.bio} 
    />

    <XiuhcoatlDivider className="text-gray-600" />

    <BlueBlood 
      title={content.blueBlood.title}
      subtitle={content.blueBlood.subtitle}
      body={content.blueBlood.body}
      tags={content.blueBlood.tags}
    />

    <Discomfort 
      title={content.discomfort.title}
      warning={content.discomfort.warning}
      body={content.discomfort.body}
    />

    <!-- Spacer with SVG background -->
    <!-- Spacer with SVG background -->
    <SteppedFretSpacer />

    <MakerLineage 
      title={content.makerLineage.title}
      id={content.makerLineage.id}
      className={content.makerLineage.class}
      body={content.makerLineage.body}
      badges={content.makerLineage.badges}
    />

    <Obsessions 
      title={content.obsessions.title}
      items={content.obsessions.items}
    />

  </div>
</PageLayout>
