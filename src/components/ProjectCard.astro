---
import Badge from "./Badge.astro";

interface Props {
  title: string;
  description: string;
  date?: string;
  version?: string;
  status?: 'WIP' | 'DONE' | 'ARCHIVED' | 'POC';
  tags?: string[];
  href?: string;
  linkText?: string;
}

const { 
  title, 
  description, 
  date, 
  version, 
  status = 'DONE', 
  tags = [], 
  href = "#",
  linkText = "DETAILS"
} = Astro.props;

const statusColors = {
  'WIP': 'warning',
  'DONE': 'success',
  'ARCHIVED': 'outline',
  'POC': 'primary'
};
---

<article class="group relative flex flex-col h-full bg-[#0a0a0a] border border-neutral-800 hover:border-primary transition-colors duration-0 overflow-hidden">
  
  <!-- Header: Spec Sheet Bar -->
  <div class="w-full bg-[#111] border-b border-neutral-800 px-4 py-2 flex justify-between items-center group-hover:bg-primary/5 transition-colors">
    <div class="flex items-center gap-2">
      <div class={`w-1.5 h-1.5 ${status === 'DONE' ? 'bg-primary' : 'bg-neutral-500'} rounded-none`}></div>
      <span class="font-mono text-[10px] text-neutral-500 uppercase tracking-widest">{status || 'WIP'} // REF-{title.substring(0,3).toUpperCase()}</span>
    </div>
    <span class="font-mono text-[10px] text-neutral-600">{version || 'V.1.0'}</span>
  </div>

  <div class="p-6 flex flex-col h-full relative">
    <!-- Decorative Corner screw -->
    <div class="absolute top-2 right-2 w-1 h-1 bg-neutral-800 rounded-full"></div>

    <!-- Title Area -->
    <div class="mb-4">
      <h3 class="text-xl font-bold text-white uppercase mb-1 group-hover:text-primary transition-colors tracking-tight">{title}</h3>
      <div class="h-px w-8 bg-neutral-800 group-hover:bg-primary group-hover:w-full transition-all duration-500"></div>
    </div>

    <!-- Metadata Grid -->
    <div class="grid grid-cols-2 gap-px bg-neutral-800 border border-neutral-800 mb-6">
      <div class="bg-[#0a0a0a] p-2">
        <span class="block text-[10px] text-neutral-600 uppercase mb-1 tracking-wider">LOG_DATE</span>
        <span class="block text-xs text-neutral-300 font-mono">{date || 'PENDING'}</span>
      </div>
      <div class="bg-[#0a0a0a] p-2">
         <span class="block text-[10px] text-neutral-600 uppercase mb-1 tracking-wider">SECTOR_ID</span>
         <span class="block text-xs text-neutral-300 font-mono">SEC-{title.length.toString().padStart(3, '0')}</span>
      </div>
    </div>

    <!-- Description (Log Entry) -->
    <div class="flex-grow">
      <p class="text-neutral-500 text-sm font-mono leading-relaxed line-clamp-3">
        {description}
      </p>
    </div>

    <!-- Stack -->
    {tags.length > 0 && (
      <div class="mt-6 pt-4 border-t border-neutral-900">
        <div class="flex flex-wrap gap-1">
          {tags.slice(0, 4).map(tag => (
            <span class="text-[10px] uppercase border border-neutral-800 px-1 py-0.5 text-neutral-500 hover:text-white hover:border-neutral-600 transition-colors">
              {tag}
            </span>
          ))}
        </div>
      </div>
    )}
  </div>

  <!-- Link Overlay -->
  <a href={href} class="absolute inset-0 z-20" aria-label={`View details for ${title}`}></a>
</article>
