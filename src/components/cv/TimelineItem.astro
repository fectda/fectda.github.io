---
import CVCard from "./CVCard.astro";
import XiuhcoatlSpine from "./XiuhcoatlSpine.astro";
import XiuhcoatlSpineMobile from "./XiuhcoatlSpineMobile.astro";

interface Props {
  year: string;
  role: string;
  company: string;
  icon: string;
  alignment: 'left' | 'right';
  nodeType: 'present' | 'past';
}

const { year, role, company, icon, alignment, nodeType } = Astro.props;

const isLeft = alignment === 'left';
const isRight = alignment === 'right';
---

<div class="col-span-2 md:col-span-3 grid grid-cols-[50px_1fr] md:grid-cols-[1fr_80px_1fr] items-center mb-12 md:mb-0">
    
    {/* Mobile Spine (Left) */}
    <XiuhcoatlSpineMobile nodeType={nodeType} />

    {/* Left Side Content (Desktop) */}
    {isLeft ? (
        <div class="order-2 md:order-1 flex justify-start md:justify-end pl-4 md:pl-0 md:pr-8 py-4 md:py-8 relative">
            {/* Connector Lines */}
            <div class="hidden md:block absolute right-0 top-1/2 w-8 h-[2px] bg-connector z-0"></div>
            <div class="md:hidden absolute left-0 top-6 w-4 h-[2px] bg-connector z-0"></div>

            <CVCard year={year} role={role} company={company} icon={icon}>
                <slot />
            </CVCard>
        </div>
    ) : (
        <div class="hidden md:block order-1"></div>
    )}

    {/* Center Spine (Desktop) */}
    <XiuhcoatlSpine nodeType={nodeType} />

    {/* Right Side Content (Desktop) */}
    {isRight ? (
        <div class="order-2 md:order-3 flex justify-start pl-4 md:pl-8 py-4 md:py-8 relative">
            {/* Connector Lines */}
            <div class="hidden md:block absolute left-0 top-1/2 w-8 h-[2px] bg-secondary z-0"></div>
            <div class="md:hidden absolute left-0 top-6 w-4 h-[2px] bg-secondary z-0"></div>

            <CVCard year={year} role={role} company={company} icon={icon}>
                <slot />
            </CVCard>
        </div>
    ) : (
        <div class="hidden md:block order-3"></div>
    )}

</div>
