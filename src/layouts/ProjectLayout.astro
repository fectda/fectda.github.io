---
import PageLayout from "./PageLayout.astro";
import Badge from "@components/Badge.astro";
import SectionHeader from "@components/SectionHeader.astro";
import { type Locale } from "@lib/i18n";

interface Props {
  title: string;
  description: string;
  date: Date;
  demoUrl?: string;
  repoUrl?: string;
  stack?: string[];
  status?: string;
  lang: Locale;
  backUrl: string;
  backLabel: string;
}

const { title, description, date, demoUrl, repoUrl, stack = [], status, lang, backUrl, backLabel } = Astro.props;

const statusLabels: Record<string, string> = {
  poc: "POC",
  wip: "WIP",
  done: "DONE",
  archived: "ARCHIVED"
};
---

<PageLayout title={title} description={description} lang={lang}>
  <div class="w-full max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="py-12 md:py-20">
      
      <!-- Back Link -->
      <a href={backUrl} class="inline-flex items-center gap-2 text-gray-500 hover:text-primary mb-8 transition-colors group">
        <span class="material-symbols-outlined text-sm group-hover:-translate-x-1 transition-transform">arrow_back</span>
        <span class="font-mono text-sm uppercase">// {backLabel}</span>
      </a>

      <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
        
        <!-- Sidebar: System Metadata -->
        <aside class="lg:col-span-4 space-y-8">
            <div class="border border-border-dark bg-surface-dark p-6 sticky top-24">
                <div class="flex items-center gap-2 mb-4 border-b border-border-dark pb-2">
                    <span class="w-2 h-2 bg-primary  animate-pulse"></span>
                    <span class="font-mono text-xs text-white/60 uppercase">System_Logs</span>
                </div>
                
                <h1 class="text-3xl font-bold uppercase text-white mb-2">{title}</h1>
                <div class="mb-6">
                     <Badge text={status ? (statusLabels[status.toLowerCase()] || status) : "UNKNOWN"} variant={status === 'done' ? 'success' : 'warning'} />
                </div>

                <div class="space-y-4 font-mono text-sm">
                    <div>
                        <span class="block text-xs text-gray-500 uppercase mb-1">Deployment_Date</span>
                        <span class="text-white">{date.toISOString().split('T')[0]}</span>
                    </div>
                    
                    {stack.length > 0 && (
                        <div>
                             <span class="block text-xs text-gray-500 uppercase mb-2">Tech_Stack</span>
                             <div class="flex flex-wrap gap-2">
                                {stack.map(tech => (
                                    <span class="px-1.5 py-0.5 border border-border-dark text-gray-400 text-xs">{tech}</span>
                                ))}
                             </div>
                        </div>
                    )}

                    <div class="pt-4 space-y-2">
                        {repoUrl && (
                            <a href={repoUrl} target="_blank" class="flex items-center gap-2 w-full border border-border-dark hover:border-primary text-gray-400 hover:text-white px-3 py-2 transition-colors">
                                <span class="material-symbols-outlined text-sm">code</span>
                                <span>Source_Code</span>
                            </a>
                        )}
                        {demoUrl && (
                            <a href={demoUrl} target="_blank" class="flex items-center gap-2 w-full bg-primary/10 border border-primary/50 hover:bg-primary/20 text-primary px-3 py-2 transition-colors">
                                <span class="material-symbols-outlined text-sm">rocket_launch</span>
                                <span>Live_Demo</span>
                            </a>
                        )}
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="lg:col-span-8">
            <SectionHeader title="SPEC_SHEET" subtitle="DETAILS" number="01" />
            <article class="prose prose-lg prose-invert max-w-none 
                prose-p:text-gray-400 prose-p:leading-relaxed prose-p:font-sans
                prose-headings:text-white prose-headings:font-display prose-headings:uppercase
                prose-strong:text-white prose-strong:font-bold
                prose-li:text-gray-400
                prose-code:text-primary prose-code:bg-surface-dark prose-code:border prose-code:border-border-dark
                prose-pre:bg-[#050505] prose-pre:border prose-pre:border-border-dark
                prose-blockquote:border-l-2 prose-blockquote:border-primary prose-blockquote:bg-surface-dark prose-blockquote:py-2 px-4
                prose-hr:border-border-dark">
                <slot />
            </article>
        </main>

      </div>
    </div>
  </div>
</PageLayout>
